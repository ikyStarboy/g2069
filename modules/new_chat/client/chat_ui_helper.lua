---
--- Generated by PluginCreator
--- new_chat gm
--- DateTime:2022-01-06
---
---
local sin = math.sin
local cos = math.cos
local rad = math.rad

---@class ChatUIHelper
local ChatUIHelper = T(World, "ChatUIHelper")

local rotationV3 ={
    {x = 1, y = 0, z = 0},
    {x = 0, y = 1, z = 0},
    {x = 0, y = 0, z = 1},
}
local function rotationToQuaternion(v3, rotation)
    local halfRotation = 0.5 * rotation
    local halfSin = sin(halfRotation)
    return {w = cos(halfRotation), x = v3.x * halfSin, y = v3.y * halfSin, z = v3.z * halfSin}
end

---rotateWidget 设置widget旋转角度
---@param widget table
---@param angle number 旋转角度
---@param axis number 坐标轴：1,2,3 => x,y,z
 function ChatUIHelper:setWidgetRotate(widget,angle,axis)
    if not widget or type(angle)~="number" or  not rotationV3[axis]   then
        print("ChatUIHelper:setWidgetRotate() error ",widget ,angle,axis)
        return
    end
    local angle = rotationToQuaternion(rotationV3[axis], rad(angle))
    widget:setProperty("Rotation", "w:"..angle.w.." x:"..angle.x.." y:"..angle.y.." z:"..angle.z)
end

-- 获取消息体widget类型
function ChatUIHelper:getContentItemType(pageType)
    --print("ChatUIHelper:getContentItemType(pageType) :",pageType)
    if pageType == Define.ChatPage.System then
        return Define.ChatMainContentType.SystemItem
    else
        return Define.ChatMainContentType.NormalItem
    end
end

-- 打开语音卡商店
function ChatUIHelper:openCardShop()
    UI:openWindow("UI/new_chat/gui/win_chat_car_shop")
end


