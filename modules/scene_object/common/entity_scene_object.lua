---
--- Generated by PluginCreator
--- scene_object entity_common
--- DateTime:2023-03-23
---

local ValueDef = T(Entity, "ValueDef")
-- key				            = {isCpp,	client,	toSelf,	toOther,	init,	               saveDB}
--ValueDef.xxx 					= {false,   false,  true,   false,      0,                      true}
ValueDef.treasureBoxData 		= {false,   false,  false,   false,      {},                      true}

local Entity = Entity

--- 获取宝箱数据
---@param itemId any
function Entity:getTreasureBoxData(itemId)
    local data = self:getValue("treasureBoxData")
    if data and data[itemId] then
        local curTime = os.time()
        local time = data[itemId].time
        if Lib.isSameDay(curTime, time) then
            return data[itemId].count or 0
        end
    end
    return 0
end

--- 添加宝箱数据
---@param itemId any
function Entity:addTreasureBoxData(itemId)
    local data = self:getValue("treasureBoxData") or {}
    if data[itemId] then
        local curTime = os.time()
        local time = data[itemId].time
        if Lib.isSameDay(curTime, time) then
            data[itemId].count = data[itemId].count + 1
        else
            data[itemId].time = curTime
            data[itemId].count = 1
        end
    else
        data[itemId] = {}
        data[itemId].time = os.time()
        data[itemId].count = 1
    end
    self:setValue("treasureBoxData", data)
end